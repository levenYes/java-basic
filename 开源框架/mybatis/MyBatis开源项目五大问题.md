# MyBatis开源项目五大问题
## 1. 形成概念。用来做什么的？
与数据库做交互。根据映射配置文件，完成数据在对象模型与关系模型之间的映射，暴露简单的API供开发人员使用。

## 2. 入门应用。怎么用？
单独使用的情况比较少，一般都会结合spring等框架使用。例如spring boot等。

第一步：数据库初始化，在项目中配置mybatis-config.xml
第二步：根据数据库，分别添加mapper文件、bean类文件和dao接口文件（可以用mybatis-generator来做）
第三步：在方法中加载该接口，调用相应方法。

## 3.应用场景。为什么要用？
传统的JDBC操作比较繁琐，有大量重复的代码。即便通过封装工具类的方式，也有许多维护的麻烦。ORM框架的主要功能就是根据映射配置文件，完成数据在对象模型与关系模型之间的映射，同时也屏蔽了上述重复的代码，只暴露简单的API供开发人员使用。

更高级的，框架可以通过集成缓存、数据源、数据库连接池等组件进行优化。开发大中型项目时，优先考虑使用ORM框架。

可对比Hibernate、Spring JDBC等同类型产品

## 4.为什么能用？实现原理。
MyBatis通过映射配置文件或相应注解将RusultSet映射为Java对象，其映射规则可以嵌套其他映射规则以及子查询，从而实现复杂的映射逻辑，也可以实现一对一、一对多、多对多映射以及双向映射。

以一次查询操作的流程为例。在MyBatis初始化过程中，会加载mybatis-config.xml配置文件、映射配置文件以及Mapper接口中的注解信息，解析后的配置信息会形成相应的对象并保存到Configuration对象中。例如示例中的\<resultMap\>节点（即ResultSet的映射规则）会被解析成ResultMap对象；\<result\>节点会被解析成ResultMapping对象。之后，利用该Configuration对象创建SqlSessionFactory对象。待mybatis初始化之后，开发人员可以通过初始化得到SqlSession对象并完成数据库操作。

SQL语句执行时，Executor主要负责维护一级缓存和二级缓存，并提供事务管理的相关操作，它会将数据库相关操作委托给StatementHandler完成。StatementHandler首先通过ParameterHandler完成SQL语句的实参绑定，然后通过java.sql.Statement对象执行SQL语句并得到结果集，最后通过ResultSetHandler完成结果集的映射，得到结果对象并返回。

## 5.阅读源码。如何用得更好？
分为三层：接口层、核心处理层、基础支持层。

接口层。其核心是SqlSession接口，该接口定义了暴露给应用程序使用的API。接口层在接收到调用请求时，会调用核心处理层的相应模块来完成具体的数据库操作。

核心处理层。在核心处理层中实现了MyBatis的核心处理流程，其中包括MyBatis的初始化以及完成一次数据库操作的涉及的全部流程。主要分为配置解析、参数映射、SQL解析、SQL执行、结果集映射、插件等几大部分。（此处可练习画出SQL执行的过程图）

基础支持层。为核心处理层的功能提供了良好的支撑。主要的模块有类型转换、日志、解析器、数据源、事务管理和缓存模块。

